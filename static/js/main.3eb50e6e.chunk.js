(this["webpackJsonpsokobot-3d"]=this["webpackJsonpsokobot-3d"]||[]).push([[0],{10:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"g",(function(){return g})),n.d(e,"f",(function(){return j})),n.d(e,"e",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return O}));var o,r,c,i=n(8),a=n(2);!function(t){t.NORTH="NORTH",t.EAST="EAST",t.SOUTH="SOUTH",t.WEST="WEST"}(c||(c={}));var h=Math.PI/2,s={NORTH:{dx:0,dy:1,angle:0},WEST:{dx:-1,dy:0,angle:h},SOUTH:{dx:0,dy:-1,angle:2*h},EAST:{dx:1,dy:0,angle:3*h}},u=(o={},Object(a.a)(o,c.NORTH,c.EAST),Object(a.a)(o,c.EAST,c.SOUTH),Object(a.a)(o,c.SOUTH,c.WEST),Object(a.a)(o,c.WEST,c.NORTH),o),b=(r={},Object(a.a)(r,c.NORTH,c.WEST),Object(a.a)(r,c.WEST,c.SOUTH),Object(a.a)(r,c.SOUTH,c.EAST),Object(a.a)(r,c.EAST,c.NORTH),r);function l(t,e){var n=Object(i.a)(t,2),o=n[0],r=n[1],c=s[e];return[o+c.dx,r+c.dy]}function g(t){return u[t]}function j(t){return b[t]}function f(t){return u[u[t]]}function d(t){return s[t].angle}function O(t,e){var n=2*Math.PI,o=(e-t)%n;return o>Math.PI?t+o-n:o<-Math.PI?t+o+n:t+o}},34:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return h}));var o=n(4),r=n(8),c=n(10),i=[{height:3,width:3,targets:[[1,2]],tiles:[[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[]},{height:1,objects:[{type:"box"}]},{height:1,objects:[]}],[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}]],robot:{position:[1,0],direction:c.a.NORTH}},{height:4,width:5,targets:[[0,1],[4,0]],tiles:[[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[{type:"box"}]},{height:0,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[]},{height:1,objects:[{type:"box"}]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[]},{height:0,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}]],robot:{position:[2,0],direction:c.a.NORTH}},{height:5,width:5,targets:[[0,0],[4,4]],tiles:[[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[]},{height:0,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[]},{height:2,objects:[]},{height:2,objects:[]},{height:1,objects:[{type:"box"},{type:"box"}]},{height:1,objects:[]}],[{height:1,objects:[]},{height:2,objects:[]},{height:2,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}]],robot:{position:[2,2],direction:c.a.NORTH}},{height:3,width:5,targets:[[0,2],[4,2]],tiles:[[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:2,objects:[]},{height:2,objects:[{type:"box"}]},{height:1,objects:[{type:"box"}]}],[{height:2,objects:[]},{height:2,objects:[{type:"box"}]},{height:1,objects:[]}],[{height:2,objects:[]},{height:2,objects:[{type:"box"}]},{height:1,objects:[]}],[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}]],robot:{position:[2,0],direction:c.a.NORTH}},{height:6,width:5,tiles:[[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}],[{height:2,objects:[]},{height:2,objects:[{type:"box"}]},{height:1,objects:[]},{height:1,objects:[]},{height:2,objects:[]},{height:2,objects:[]}],[{height:2,objects:[]},{height:2,objects:[{type:"box"}]},{height:1,objects:[]},{height:1,objects:[]},{height:2,objects:[{type:"box"}]},{height:2,objects:[]}],[{height:2,objects:[]},{height:2,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:2,objects:[{type:"box"}]},{height:2,objects:[]}],[{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]},{height:1,objects:[]}]],targets:[[0,2],[0,3],[4,0],[4,5]],robot:{position:[2,0],direction:c.a.NORTH}}];function a(){return i.map((function(t,e){return"Level ".concat(e+1)}))}function h(t){var e=i[t];if(e)return function(t,e){var n=Object(r.a)(e.robot.position,2),c=n[0],i=n[1],a=e.tiles[c][i],h=a.height+a.objects.length;return Object(o.a)(Object(o.a)({},e),{},{robot:Object(o.a)(Object(o.a)({},e.robot),{},{key:s(t,c,i,h)}),tiles:e.tiles.map((function(e,n){return e.map((function(e,r){var c=e.height,i=e.objects;return{height:c,objects:i.map((function(e,i){return Object(o.a)(Object(o.a)({},e),{},{key:s(t,n,r,c+1+i)})}))}}))}))})}(t,e)}function s(t,e,n,o){return[t,e,n,o].join("-")}},50:function(t,e,n){"use strict";var o={};n.r(o),n.d(o,"selectLevel",(function(){return T})),n.d(o,"clearLevel",(function(){return S}));var r={};n.r(r),n.d(r,"getSelectedLevel",(function(){return y})),n.d(r,"isUnlocked",(function(){return R})),n.d(r,"getNextLevel",(function(){return _}));var c={};n.r(c),n.d(c,"startLevel",(function(){return k})),n.d(c,"finishLevel",(function(){return x})),n.d(c,"moveForward",(function(){return V})),n.d(c,"moveBackward",(function(){return H})),n.d(c,"turnRight",(function(){return W})),n.d(c,"turnLeft",(function(){return I})),n.d(c,"move",(function(){return M}));var i={};n.r(i),n.d(i,"getRobotPosition",(function(){return G})),n.d(i,"getRobotDirection",(function(){return D})),n.d(i,"getRobotKey",(function(){return P})),n.d(i,"getMapDimensions",(function(){return B})),n.d(i,"getTilesInfo",(function(){return K})),n.d(i,"getMovableObjectsInfo",(function(){return J})),n.d(i,"isLevelCleared",(function(){return z}));var a={};n.r(a),n.d(a,"toggleOnScreenControls",(function(){return Y}));var h={};n.r(h),n.d(h,"displayOnScreenControls",(function(){return Z}));var s=n(15),u=n(4),b=n(9),l=n(10),g=n(8);function j(t,e){var n=Object(g.a)(e,2),o=n[0],r=n[1];return t[o]?t[o][r]:void 0}var f=function(t,e,n){var o=Object(l.d)(e,n),r=Object(l.d)(o,n);return[j(t,e),j(t,o),j(t,r)]};var d=function(t){var e=function(t){return t.objects.some((function(t){return"box"===t.type}))};return!t.targets.some((function(n){var o=Object(g.a)(n,2),r=o[0],c=o[1];return!e(t.tiles[r][c])}))&&!t.tiles.some((function(n,o){return n.some((function(n,r){return e(n)&&!t.targets.some((function(t){var e=Object(g.a)(t,2),n=e[0],c=e[1];return n===o&&c===r}))}))}))};function O(t){return void 0!==t&&t.height>0}var v=function(t,e,n){if(!O(e))return!1;if(e.height>t.height+t.objects.length)return!1;var o=t.height+t.objects.length;if(e.objects.slice(o-e.height).length>0){if(!O(n))return!1;if(n.height+n.objects.length>o)return!1}return!0};var p=function(t,e,n){var o=Object(l.d)(e,n),r=Object(g.a)(e,2),c=r[0],i=r[1],a=Object(g.a)(o,2),h=a[0],b=a[1],j=Object(l.d)(o,n),f=Object(g.a)(j,2),d=f[0],O=f[1],v=t[c][i],p=v.height+v.objects.length;return t.map((function(e,n){return e.map((function(e,o){if(n===h&&o===b)return Object(u.a)(Object(u.a)({},e),{},{objects:e.objects.slice(0,p-e.height)});if(n===d&&o===O){var r=t[h][b];return Object(u.a)(Object(u.a)({},e),{},{objects:[].concat(Object(s.a)(e.objects),Object(s.a)(r.objects.slice(p-r.height)))})}return e}))}))};var E,m=n(11),L=n(34);function T(t){return{type:E.SELECT_LEVEL,payload:{level:t}}}function S(){return{type:E.CLEAR_LEVEL}}function y(t){return t.selectedLevel}function R(t,e){return e<t.unlockedLevels}function _(t){if(void 0!==t.selectedLevel){var e=t.selectedLevel+1;if(e in Object(L.b)())return e}}!function(t){t.SELECT_LEVEL="levels/SELECT_LEVEL",t.CLEAR_LEVEL="levels/CLEAR_LEVEL"}(E||(E={}));var w={unlockedLevels:1};function N(t){if(t.startsWith("/level/"))return parseInt(t.substr("/level/".length))}var C,A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case m.b:var n=N(e.payload.location.pathname);return void 0!==n?Object(b.d)(t,b.a.action(T(n))):t;case E.SELECT_LEVEL:var o=e.payload.level,r=Object(L.a)(o);return r&&R(t,o)?Object(b.d)(Object(u.a)(Object(u.a)({},t),{},{selectedLevel:o}),b.a.action(c.startLevel(r))):t;case E.CLEAR_LEVEL:return Object(u.a)(Object(u.a)({},t),{},{unlockedLevels:t.unlockedLevels+(t.selectedLevel===t.unlockedLevels-1?1:0)});default:return t}};function k(t){return{type:C.START_LEVEL,payload:{map:t}}}function x(){return{type:C.FINISH_LEVEL}}function V(){return{type:C.MOVE_FORWARD}}function H(){return{type:C.MOVE_BACKWARD}}function W(){return{type:C.TURN_RIGHT}}function I(){return{type:C.TURN_LEFT}}function M(t){return{type:C.MOVE,payload:t}}!function(t){t.START_LEVEL="game/START_LEVEL",t.FINISH_LEVEL="game/FINISH_LEVEL",t.MOVE="game/MOVE",t.MOVE_FORWARD="game/MOVE_FORWARD",t.MOVE_BACKWARD="game/MOVE_BACKWARD",t.TURN_RIGHT="game/TURN_RIGHT",t.TURN_LEFT="game/TURN_LEFT"}(C||(C={}));var U={finished:!1};function F(t,e){var n=f(t.tiles,t.robot.position,e);return v.apply(void 0,Object(s.a)(n))}function G(t){X(t);var e=Object(g.a)(t.map.robot.position,2),n=e[0],o=e[1];return[n,o,t.map.tiles[n][o].height+t.map.tiles[n][o].objects.length+1]}function D(t){return X(t),t.map.robot.direction}function P(t){return X(t),t.map.robot.key}function B(t){return X(t),[t.map.width,t.map.height]}function K(t){X(t);for(var e=t.map.tiles,n=new Set(t.map.targets.map((function(t){return t.join("-")}))),o=[],r=0;r<e.length;r++)for(var c=0;c<e[r].length;c++){var i=e[r][c].height,a=n.has(r+"-"+c);o.push({x:r,y:c,height:i,hasTarget:a})}return o}function J(t){X(t);for(var e=t.map.tiles,n=[],o=function(t){for(var o=function(o){var r=e[t][o].objects.map((function(n,r){return Object(u.a)(Object(u.a)({},n),{},{position:[t,o,e[t][o].height+r+1]})}));n.push.apply(n,Object(s.a)(r))},r=0;r<e[t].length;r++)o(r)},r=0;r<e.length;r++)o(r);return n}function z(t){return t.finished}function X(t){if(!t.map)throw Error("No map defined.")}var $,q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,e=arguments.length>1?arguments[1]:void 0;if(e.type===C.START_LEVEL){var n=e.payload.map;return{finished:!1,map:n}}if(!t.map)return t;switch(e.type){case C.MOVE_FORWARD:var r=t.map.robot.direction;return F(t.map,r)?Object(b.d)(t,b.a.action(M(r))):t;case C.MOVE_BACKWARD:var c=Object(l.e)(t.map.robot.direction);return F(t.map,c)?Object(b.d)(t,b.a.action(M(c))):t;case C.TURN_RIGHT:return Object(u.a)(Object(u.a)({},t),{},{map:Object(u.a)(Object(u.a)({},t.map),{},{robot:Object(u.a)(Object(u.a)({},t.map.robot),{},{direction:Object(l.g)(t.map.robot.direction)})})});case C.TURN_LEFT:return Object(u.a)(Object(u.a)({},t),{},{map:Object(u.a)(Object(u.a)({},t.map),{},{robot:Object(u.a)(Object(u.a)({},t.map.robot),{},{direction:Object(l.f)(t.map.robot.direction)})})});case C.MOVE:var i=Object(u.a)(Object(u.a)({},t),{},{map:Object(u.a)(Object(u.a)({},t.map),{},{tiles:p(t.map.tiles,t.map.robot.position,e.payload),robot:Object(u.a)(Object(u.a)({},t.map.robot),{},{position:Object(l.d)(t.map.robot.position,e.payload)})})});return d(i.map)?Object(b.d)(i,b.a.action(x())):i;case C.FINISH_LEVEL:return Object(b.d)(Object(u.a)(Object(u.a)({},t),{},{finished:!0}),b.a.action(o.clearLevel()));default:return t}};!function(t){t.TOGGLE_ON_SCREEN_CONTROLS="settings/TOGGLE_ON_SCREEN_CONTROLS"}($||($={}));var Q={onScreenControls:!0};function Y(){return{type:$.TOGGLE_ON_SCREEN_CONTROLS}}function Z(t){return t.onScreenControls}var tt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case $.TOGGLE_ON_SCREEN_CONTROLS:return{onScreenControls:!t.onScreenControls};default:return e.type,t}},et=n(64),nt=n(18),ot=n(27),rt=n(22);var ct,it=function(t){return Object(b.b)({game:q,levels:A,router:Object(rt.b)(t),settings:tt})};function at(t,e){var n=new Map(Object.entries(t.getState()));t.subscribe((function(){var o=new Map(Object.entries(t.getState())),r=e.filter((function(t){return o.get(t)!==n.get(t)}));r.forEach((function(t){!function(t,e){try{var n=JSON.stringify(e);localStorage.setItem(t,n)}catch(o){console.warn('Failed to persist the state of slice "'.concat(t,'"'),o)}}(t,o.get(t))})),r.length>0&&(n=o)}))}var ht=["levels","settings"],st=null!==(ct=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__)&&void 0!==ct?ct:ot.c;var ut=function(){var t=function(t){var e={};return t.forEach((function(t){try{var n=localStorage.getItem(t);n&&(e[t]=JSON.parse(n))}catch(o){console.warn('Failed to load the state of slice "'.concat(t,'"'),o)}})),e}(ht),e=Object(nt.a)({basename:"sokobot-3d"}),n=st(Object(ot.a)(Object(et.a)(e)),Object(b.c)()),o=(0,ot.d)(it(e),t,n);return at(o,ht),{store:o,history:e}};n.d(e,"a",(function(){return ut})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return r})),n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return h}))},53:function(t,e,n){"use strict";var o=n(29),r=n(49),c=n(0),i=n.n(c);function a(){var t=Object(o.a)(["\n  text-align: center;\n"]);return a=function(){return t},t}var h=n(1).default.h1(a());e.a=function(t){var e=t.title,n=t.children;return i.a.createElement(r.a,{width:"medium"},i.a.createElement("header",null,i.a.createElement(h,null,e)),i.a.createElement(r.a,{width:"medium",gap:"small",align:"stretch"},n))}},87:function(t,e,n){t.exports=n(99)},99:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),c=n(33),i=n.n(c),a=n(22),h=n(109),s=n(108),u=n(20),b=n(13),l={global:{colors:{icon:{dark:"text"},brand:"#7D4CDB",control:"brand",text:"#aaa",background:"#000"},font:{family:"Arial"}}},g=n(50),j=n(11),f=n(110),d=n(106),O=n(107),v=n(53);var p=Object(u.c)(null,(function(t){return{startGame:function(){return t(Object(j.e)("/select-level"))},openSettings:function(){return t(Object(j.e)("/settings"))}}}))((function(t){var e=t.startGame,n=t.openSettings;return r.a.createElement(v.a,{title:"Sokobot"},r.a.createElement(f.a,{icon:r.a.createElement(d.a,null),label:"Start Game",onClick:e}),r.a.createElement(f.a,{icon:r.a.createElement(O.a,null),label:"Settings",onClick:n}))})),E=Object(o.lazy)((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,151))})),m=Object(o.lazy)((function(){return n.e(5).then(n.bind(null,153))})),L=Object(o.lazy)((function(){return n.e(6).then(n.bind(null,152))})),T=Object(g.a)(),S=T.store,y=T.history;var R=function(){return r.a.createElement(u.a,{store:S},r.a.createElement(a.a,{history:y},r.a.createElement(h.a,{full:!0,theme:l},r.a.createElement(s.a,{align:"center"},r.a.createElement(o.Suspense,{fallback:r.a.createElement("div",null,"Loading...")},r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:"/",component:p}),r.a.createElement(b.b,{exact:!0,path:"/settings",component:L}),r.a.createElement(b.b,{exact:!0,path:"/select-level",component:m}),r.a.createElement(b.b,{exact:!0,path:"/level/:level",component:E}),r.a.createElement(b.b,{render:function(){return r.a.createElement(b.a,{to:"/"})}})))))))},_=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function w(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var n=t.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}i.a.render(r.a.createElement(R,null),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/sokobot-3d",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/sokobot-3d","/service-worker.js");_?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):w(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):w(e,t)}))}}()}},[[87,1,2]]]);
//# sourceMappingURL=main.3eb50e6e.chunk.js.map